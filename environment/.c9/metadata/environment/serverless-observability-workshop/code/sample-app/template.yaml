{"filter":false,"title":"template.yaml","tooltip":"/serverless-observability-workshop/code/sample-app/template.yaml","undoManager":{"mark":5,"position":5,"stack":[[{"start":{"row":21,"column":46},"end":{"row":22,"column":0},"action":"insert","lines":["",""],"id":3},{"start":{"row":22,"column":0},"end":{"row":22,"column":8},"action":"insert","lines":["        "]}],[{"start":{"row":22,"column":8},"end":{"row":23,"column":75},"action":"insert","lines":["AWS_NODEJS_CONNECTION_REUSE_ENABLED: 1","        AWS_EMF_NAMESPACE: MonitoringApp # <----- ADD FOR NAMESPACE SETUP  "],"id":4}],[{"start":{"row":21,"column":8},"end":{"row":21,"column":46},"action":"remove","lines":["AWS_NODEJS_CONNECTION_REUSE_ENABLED: 1"],"id":5}],[{"start":{"row":21,"column":0},"end":{"row":21,"column":8},"action":"remove","lines":["        "],"id":6},{"start":{"row":20,"column":100},"end":{"row":21,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":25,"column":0},"end":{"row":31,"column":21},"action":"remove","lines":["","Resources:","# API Gateway","  Api:","    Type: AWS::Serverless::Api","    Properties:","      StageName: Prod"],"id":7},{"start":{"row":25,"column":0},"end":{"row":60,"column":0},"action":"insert","lines":["Resources:","# API Gateway","  Api:","    Type: AWS::Serverless::Api","    DependsOn: ApiCWLRoleArn","    Properties:","      StageName: Prod","      AccessLogSetting:","        DestinationArn: !Sub ${ApiAccessLogGroup.Arn} # This Log Group is already created within our SAM Template","        Format: \"{ 'requestId':'$context.requestId', 'ip': '$context.identity.sourceIp', 'caller':'$context.identity.caller', 'user':'$context.identity.user','requestTime':'$context.requestTime', 'xrayTraceId':'$context.xrayTraceId', 'wafResponseCode':'$context.wafResponseCode', 'httpMethod':'$context.httpMethod','resourcePath':'$context.resourcePath', 'status':'$context.status','protocol':'$context.protocol', 'responseLength':'$context.responseLength' }\"","      MethodSettings:","        - MetricsEnabled: True","          ResourcePath: '/*'","          HttpMethod: '*'","","  ApiCWLRoleArn:","    Type: AWS::ApiGateway::Account","    Properties: ","      CloudWatchRoleArn: !GetAtt CloudWatchRole.Arn","","# IAM Role for API GW + CWL","  CloudWatchRole:","      Type: AWS::IAM::Role","      Properties:","        AssumeRolePolicyDocument:","          Version: '2012-10-17'","          Statement:","            Action: 'sts:AssumeRole'","            Effect: Allow","            Principal:","              Service: apigateway.amazonaws.com","        Path: /","        ManagedPolicyArns:","          - 'arn:aws:iam::aws:policy/service-role/AmazonAPIGatewayPushToCloudWatchLogs'","      ",""]}],[{"start":{"row":24,"column":24},"end":{"row":25,"column":0},"action":"insert","lines":["",""],"id":8},{"start":{"row":25,"column":0},"end":{"row":25,"column":4},"action":"insert","lines":["    "]}]]},"ace":{"folds":[],"scrolltop":420,"scrollleft":0,"selection":{"start":{"row":58,"column":26},"end":{"row":58,"column":26},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1647433598829,"hash":"15940ecdc8baa20247adac9b7b5b7f2e4fb4e010"}